<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      font-size: 12px;
      margin: 0;
      padding: 20px;
      position: relative;
    }

    /* ===== WATERMARK ===== */
    .watermark {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-35deg);
      font-size: 80px;
      color: rgba(0, 0, 0, 0.08);
      font-weight: bold;
      z-index: -1;
      white-space: nowrap;
    }

    /* ===== HEADER ===== */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid #000;
      padding-bottom: 10px;
      margin-bottom: 15px;
    }

    .logo img {
      max-height: 70px;
    }

    .company-details {
      text-align: right;
      font-size: 12px;
    }

    /* ===== TABLE ===== */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    th, td {
      border: 1px solid #333;
      padding: 6px;
      text-align: center;
      vertical-align: middle;
    }

    th {
      background-color: #f2f2f2;
      font-weight: bold;
    }

    .text-right {
      text-align: right;
    }

    .summary {
      margin-top: 15px;
      width: 40%;
      float: right;
    }

    .summary td {
      border: none;
      padding: 4px;
    }

    .footer {
      margin-top: 50px;
      font-size: 10px;
      text-align: center;
      clear: both;
    }
  </style>
</head>

<body>

<!-- ===== WATERMARK TEXT ===== -->
<div class="watermark">
  PERFUME VALLEY
</div>

<!-- ===== HEADER ===== -->
<div class="header">
  <div class="logo">
    <img src="{{ logo_url }}" alt="Company Logo">
  </div>

  <div class="company-details">
    <strong>{{ company_name }}</strong><br>
    {{ company_address }}<br>
    <strong>GSTIN:</strong> {{ company_gstin }}
  </div>
</div>

<h3>Tax Invoice</h3>

<p>
  <strong>Invoice No:</strong> {{ order.invoice_number }}<br>
  <strong>Invoice Date:</strong> {{ order.invoice_date }}<br>
  <strong>Customer:</strong> {{ order.address.Name }}<br>
  <strong>Mobile:</strong> {{ order.address.MobileNumber }}<br>
  <strong>State:</strong> {{ order.address.State }}
</p>

<!-- ===== ITEMS TABLE ===== -->
<table>
  <thead>
    <tr>
      <th>Product</th>
      <th>SKU</th>
      <th>Qty</th>
      <th>Unit Price<br>(Before Tax)</th>
      <th>Taxable Value<br>(Tax Amount)</th>
      <th>CGST</th>
      <th>SGST</th>
      <th>IGST</th>
      <th>Total</th>
    </tr>
  </thead>

  <tbody>
    {% for i in items %}
    <tr>
      <td>{{ i.product }}</td>
      <td>{{ i.sku }}</td>
      <td>{{ i.qty }}</td>
      <td>₹{{ i.unit_price }}</td>
      <td>₹{{ i.taxable_value }}</td>

      <td>
        {% if i.cgst %}
          ₹{{ i.cgst }} ({{ i.cgst_rate }}%)
        {% else %}
          -
        {% endif %}
      </td>

      <td>
        {% if i.sgst %}
          ₹{{ i.sgst }} ({{ i.sgst_rate }}%)
        {% else %}
          -
        {% endif %}
      </td>

      <td>
        {% if i.igst %}
          ₹{{ i.igst }} ({{ i.igst_rate }}%)
        {% else %}
          -
        {% endif %}
      </td>

      <td>₹{{ i.total }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- ===== SUMMARY ===== -->
<table class="summary">
  <tr>
    <td class="text-right"><strong>Subtotal (Before Tax):</strong></td>
    <td class="text-right">₹{{ subtotal }}</td>
  </tr>
  <tr>
    <td class="text-right"><strong>Total GST:</strong></td>
    <td class="text-right">₹{{ total_tax }}</td>
  </tr>
  <tr>
    <td class="text-right"><strong>Grand Total:</strong></td>
    <td class="text-right"><strong>₹{{ grand_total }}</strong></td>
  </tr>
</table>

<!-- ===== FOOTER ===== -->
<div class="footer">
  <p>
    This is a computer-generated invoice and does not require a signature.<br>
    Thank you for shopping with <strong>{{ company_name }}</strong>.
  </p>
</div>

</body>
</html>
